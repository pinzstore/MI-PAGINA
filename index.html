<section id="testimonios" class="py-16 bg-white relative">
  <div class="container mx-auto px-6 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
    
    <!-- Columna izquierda -->
    <div class="text-left animate-slide-left">
      <h2 class="text-4xl font-extrabold text-gray-900 leading-snug">
        ¿Qué opinan <br /> nuestros clientes?
      </h2>
    </div>

    <!-- Columna derecha (Testimonios) -->
    <div class="relative">
      <canvas id="particlesCanvas" class="absolute inset-0 pointer-events-none"></canvas>
      <div id="testimonial-container" class="relative"></div>
    </div>

  </div>
</section>

<style>
/* Animación de entrada para el título */
@keyframes slide-left {
  from {
    opacity: 0;
    transform: translateX(-50px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
.animate-slide-left {
  animation: slide-left 1s ease-out forwards;
}

/* Estilos tarjetas */
.testimonial-card {
  background: white;
  padding: 1.5rem;
  border-radius: 0.75rem;
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  text-align: center;
  max-width: 400px;
  margin: auto;
  position: relative;
  z-index: 10;
  opacity: 0;
  transform: translateX(50px);
  transition: opacity 0.5s ease, transform 0.5s ease;
}
.testimonial-card.show {
  opacity: 1;
  transform: translateX(0);
}
</style>

<script>
// Testimonios
const testimonials = [
  { text: "Excelente servicio y atención.", author: "Carlos M.", rating: 5 },
  { text: "Fácil de usar y confiable.", author: "Luisa P.", rating: 5 },
  { text: "Muy recomendable, volveré a comprar.", author: "Andrés G.", rating: 5 }
];

let currentIndex = 0;
const container = document.getElementById("testimonial-container");
const canvas = document.getElementById("particlesCanvas");
const ctx = canvas.getContext("2d");

canvas.width = container.offsetWidth;
canvas.height = container.offsetHeight;

window.addEventListener("resize", () => {
  canvas.width = container.offsetWidth;
  canvas.height = container.offsetHeight;
});

// Función para mostrar testimonial
function showTestimonial(index) {
  container.innerHTML = "";
  const testimonial = testimonials[index];

  const card = document.createElement("div");
  card.className = "testimonial-card show";
  card.innerHTML = `
    <p class="text-gray-700 italic">"${testimonial.text}"</p>
    <p class="text-gray-900 font-bold mt-2">${testimonial.author}</p>
    <div class="flex justify-center mt-3">
      ${"★".repeat(testimonial.rating)}${"☆".repeat(5 - testimonial.rating)}
    </div>
  `;

  container.appendChild(card);

  // Auto-destruir la tarjeta después de 3s
  setTimeout(() => {
    explode(card);
    card.classList.remove("show");
    setTimeout(() => {
      currentIndex = (currentIndex + 1) % testimonials.length;
      showTestimonial(currentIndex);
    }, 800);
  }, 3000);
}

// Partículas
class Particle {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.size = Math.random() * 5 + 2;
    this.speedX = (Math.random() - 0.5) * 6;
    this.speedY = (Math.random() - 0.5) * 6;
    this.life = 30;
  }
  update() {
    this.x += this.speedX;
    this.y += this.speedY;
    this.life--;
  }
  draw() {
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fillStyle = "yellow";
    ctx.fill();
  }
}

let particles = [];

function explode(card) {
  const rect = card.getBoundingClientRect();
  const centerX = rect.left + rect.width / 2 - container.getBoundingClientRect().left;
  const centerY = rect.top + rect.height / 2 - container.getBoundingClientRect().top;

  for (let i = 0; i < 50; i++) {
    particles.push(new Particle(centerX, centerY));
  }
}

function animateParticles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  particles = particles.filter(p => p.life > 0);
  particles.forEach(p => {
    p.update();
    p.draw();
  });
  requestAnimationFrame(animateParticles);
}

animateParticles();
showTestimonial(currentIndex);
</script>
